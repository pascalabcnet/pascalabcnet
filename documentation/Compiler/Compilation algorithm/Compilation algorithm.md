
Owner: Alexander Zemlyak
Tags: Infrastructure

### –ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ –ø—Å–µ–≤–¥–æ–∫–æ–¥–µ

- –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è
    
    ```
    CompileUnit(–ò–º—è–§–∞–π–ª–∞)
    1.CompileUnit(new –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π, –ò–º—è–§–∞–π–ª–∞)
    2.–î–æ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª–∏ –∏–∑ –°–ø–∏—Å–æ–∫–û—Ç–ª–æ–∂–µ–Ω–æ–π–ö–æ–º–ø–∏–ª—è—Ü–∏–∏;
    
    CompileUnit(–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π, –ò–º—è–§–∞–π–ª–∞)
    1.–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å = –¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–ò–º—è–§–∞–π–ª–∞];
      –ï—Å–ª–∏ (–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å != 0) —Ç–æ
         –ï—Å–ª–∏ (–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–æ—Å—Ç–æ—è–Ω–∏–µ != BeginCompilation)
          –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
          –í—ã—Ö–æ–¥;
        –∏–Ω–∞—á–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—É–Ω–∫—Ç—É 5
    
    2.–ï—Å–ª–∏ –≠—Ç–æ–§–∞–π–ªDLL(–ò–º—è–§–∞–π–ª–∞) —Ç–æ
        –ï—Å–ª–∏ ((–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å = –°—á–∏—Ç–∞—Ç—åDLL(–ò–º—è–§–∞–π–ª–∞)) != 0) —Ç–æ
          –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
          –¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
          –í—ã—Ö–æ–¥;
        –∏–Ω–∞—á–µ
          –û—à–∏–±–∫–∞("–ù–µ –º–æ–≥—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Å–±–æ—Ä–∫—É");
          –í—ã—Ö–æ–¥;
    
    3.–ï—Å–ª–∏ –≠—Ç–æ–§–∞–π–ªPCU(–ò–º—è–§–∞–π–ª–∞) —Ç–æ
        –ï—Å–ª–∏ ((–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å = –°—á–∏—Ç–∞—Ç—åPCU(–ò–º—è–§–∞–π–ª–∞)) != 0) —Ç–æ
          –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
          –¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
          –í—ã—Ö–æ–¥;
        –∏–Ω–∞—á–µ
          –∏–Ω–∞—á–µ –ø–µ—Ä–µ–π—Ç–∏ –∫ –ø—É–Ω–∫—Ç—É 4;
    
    4.–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å = –Ω–æ–≤—ã–π–ú–æ–¥—É–ª—å();
      –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ = –ü–∞—Ä–∞—Å–µ—Ä—ã.–ü–∞—Ä—Å–∏—Ç—å(–ò–º—è–§–∞–π–ª–∞,–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫);
      –ï—Å–ª–∏ (–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ == 0) —Ç–æ
         –ï—Å–ª–∏ (–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ == 0) —Ç–æ
           –û—à–∏–±–∫–∞("–ú–æ–¥—É–ª—å –Ω–µ –Ω–µ–∞–π–¥–µ–Ω");
         –∏–Ω–∞—á–µ
           –û—à–∏–±–∫–∞(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫[0]);
      –¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–ò–º—è–§–∞–π–ª–∞] = –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å;
      –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–æ—Å—Ç–æ—è–Ω–∏–µ = BeginCompilation;
    
    5.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π = –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ.Interface.usesList;
      –î–ª—è(i = –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ - 1 - –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã–µ–íInterface.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ; i >= 0; i--)
         –¢–µ–∫—É—à–∏–π–ú–æ–¥—É–ª—å.–¢–µ–∫—É—â–∏–πUses–ú–æ–¥—É–ª—å = –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π[i].–ò–º—è–§–∞–π–ª–∞;
         –ò–º—èUses–§–∞–π–ª–∞ = –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π[i].–ò–º—è–§–∞–π–ª–∞;
         –ï—Å–ª–∏ (–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–ò–º—èUses–§–∞–π–ª–∞] != 0)
           –ï—Å–ª–∏ (–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–ò–º—èUses–§–∞–π–ª–∞].–°–æ—Å—Ç–æ—è–Ω–∏–µ == BeginCompilation)
             –ï—Å–ª–∏ (–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–ò–º—èUses–§–∞–π–ª–∞].–¢–µ–∫—É—â–∏–πUses–ú–æ–¥—É–ª—å].–°–æ—Å—Ç–æ—è–Ω–∏–µ=BeginCompilation)
                –û—à–∏–±–∫–∞("–¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å –º–æ–¥—É–ª–µ–π");
         CompileUnit(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã–µ–íInterface, –ò–º—èUses–§–∞–π–ª–∞);
         –ï—Å–ª–∏ (–¢–µ–∫—É—à–∏–π–ú–æ–¥—É–ª—å.–°–æ—Å—Ç–æ—è–Ω–∏–µ == Compiled) —Ç–æ
           –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—à–∏–π–ú–æ–¥—É–ª—å);
           –í—ã—Ö–æ–¥;
    
    6.–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ = –ö–æ–Ω–≤–µ—Ä—Ç–æ—Ä–î–µ—Ä–µ–≤–∞.–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—åInterface–ß–∞—Å—Ç—å(
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ,
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã–µ–íInterface,
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫);
      –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
      –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π = –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ.Implementation.usesList;
      –î–ª—è(i = –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π.–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ - 1; i >= 0; i--)
        –ï—Å–ª–∏ (–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π[i].–ò–º—è–§–∞–π–ª–∞].–°–æ—Å—Ç–æ—è–Ω–∏–µ == BeginCompilation)
          –°–ø–∏—Å–æ–∫–û—Ç–ª–æ–∂–µ–Ω–æ–π–ö–æ–º–ø–∏–ª—è—Ü–∏–∏.–î–æ–±–∞–≤–∏—Ç—å(–¢–∞–±–ª–∏—Ü–∞–ú–æ–¥—É–ª–µ–π[–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π[i].–ò–º—è–§–∞–π–ª–∞]);
        –∏–Ω–∞—á–µ
          CompileUnit(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã–µ–íImplementation, –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π[i].–ò–º—è–§–∞–π–ª–∞);
      –ï—Å–ª–∏(–î–æ–±–∞–≤–ª—è–ª–∏–•–æ—Ç—è–±—ã–û–¥–∏–Ω–í–°–ø–∏—Å–æ–∫–û—Ç–ª–æ–∂–µ–Ω–æ–π–ö–æ–º–ø–∏–ª—è—Ü–∏–∏)
        –°–ø–∏—Å–æ–∫–û—Ç–ª–æ–∂–µ–Ω–æ–π–ö–æ–º–ø–∏–ª—è—Ü–∏–∏.–î–æ–±–∞–≤–∏—Ç—å(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
        –≤—ã—Ö–æ–¥;
      –∏–Ω–∞—á–µ
        –ö–æ–Ω–≤–µ—Ä—Ç–æ—Ä–î–µ—Ä–µ–≤–∞.–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—åImplementation–ß–∞—Å—Ç—å(
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ,
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ–î–µ—Ä–µ–≤–æ,
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–ö–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã–µ–íImplementation
                                          –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–ø–∏—Å–æ–∫–û—à–∏–±–æ–∫);
      –¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å.–°–æ—Å—Ç–æ—è–Ω–∏–µ = Compiled;
      –°–æ—Ö—Ä–∞–Ω–∏—Ç—åPCU(–¢–µ–∫—É—â–∏–π–ú–æ–¥—É–ª—å);
    ```
    
- –ö—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è (–º–µ–Ω—å—à–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π)
    
    ```
    CompileUnit(–ò–º—è–§–∞–π–ª–∞)
      1.CompileUnit(new –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π, –ò–º—è–§–∞–π–ª–∞)
      2.–î–æ–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª–∏ –∏–∑ –°–ø–∏—Å–æ–∫–û—Ç–ª–æ–∂–µ–Ω–æ–π–ö–æ–º–ø–∏–ª—è—Ü–∏–∏;
    
    CompileUnit(–°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π, –ò–º—è–§–∞–π–ª–∞);
      1.–ï—Å–ª–∏ —É —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –æ—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —Ö–æ—Ç—è–±—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–æ
          –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π
          –≤—ã—Ö–æ–¥
      2.–ï—Å–ª–∏ —ç—Ç–æ DLL —Ç–æ
          —Å—á–∏—Ç–∞—Ç—å
          –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π
          –≤—ã—Ö–æ–¥
      3.–ï—Å–ª–∏ —ç—Ç–æ PCU —Ç–æ
          —Å—á–∏—Ç–∞—Ç—å
          –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π
          –≤—ã—Ö–æ–¥
      4.—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã–π–ú–æ–¥—É–ª—å
        –†–∞—Å–ø–∞—Ä—Å–∏—Ç—å–¢–µ–∫—Å—Ç(–ò–º—è–§–∞–π–ª–∞)
        –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ BeginCompilation
      5.–î–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∏–∑ Interface —á–∞—Å—Ç–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ
          –ï—Å–ª–∏ –º—ã —É–∂–µ –Ω–∞—á–∞–∏–Ω–∞–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–æ–¥—É–ª—å
            –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–¥—É–ª—è BeginCompilation
              –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ –∏–º –º–æ–¥—É–ª—è BeginCompilation
                –æ—à–∏–±–∫–∞("–¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å –º–æ–¥—É–ª–µ–π")
                –≤—ã—Ö–æ–¥
          CompileUnit(–°–ø–∏—Å–æ–∫ –∏–∑ Interface —á–∞—Å—Ç–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è,–º–æ–¥—É–ª—å.–∏–º—è)
          –ï—Å–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã–π–ú–æ–¥—É–ª—å.–°–æ—Å—Ç–æ—è–Ω–∏–µ Compiled —Ç–æ
            –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π
            –≤—ã—Ö–æ–¥
      6.–û—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å Interface —á–∞—Å—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è
        –î–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –∏–∑ Implementation —á–∞—Å—Ç–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ
          –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è BeginCompilation —Ç–æ
            –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Å–ø–∏—Å–æ–∫ –æ—Ç–ª–æ–∂–µ–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏;
          –∏–Ω–∞—á–µ
            CompileUnit(–°–ø–∏—Å–æ–∫ –∏–∑ Implementation —á–∞—Å—Ç–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è,–º–æ–¥—É–ª—å.–∏–º—è)
        –ï—Å–ª–∏ –î–æ–±–∞–≤–ª—è–ª–∏ –•–æ—Ç—è –±—ã –û–¥–∏–Ω –í –°–ø–∏—Å–æ–∫ –û—Ç–ª–æ–∂–µ–Ω–æ–π –ö–æ–º–ø–∏–ª—è—Ü–∏–∏ —Ç–æ
          –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã–π–ú–æ–¥—É–ª—å –≤ —Å–ø–∏—Å–æ–∫ –æ—Ç–ª–æ–∂–µ–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏
          –≤—ã—Ö–æ–¥
        –û—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å Implementation —á–∞—Å—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è
        –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º–æ–≥–æ–ú–æ–¥—É–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ Compiled
        –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ –°–ø–∏—Å–æ–∫–ú–æ–¥—É–ª–µ–π
        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º—ã–π–ú–æ–¥—É–ª—å –≤ –≤–∏–¥–µ PCU —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫
    ```
    

### –°–ª–æ–≤–µ—Å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–ú–æ–¥—É–ª–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º –ø–æ—Ä—è–¥–∫—É **–æ–±—Ö–æ–¥–∞ –≤ –≥–ª—É–±–∏–Ω—É** –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –û–±—Ö–æ–¥ –≤ –≥–ª—É–±–∏–Ω—É —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–∏ CompileUnit. 

–°–Ω–∞—á–∞–ª–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã—Ö —á–∞—Å—Ç–µ–π –º–æ–¥—É–ª–µ–π, –ø—Ä–∏—á–µ–º –≤ –ø–æ—Ä—è–¥–∫–µ **–æ–±—Ä–∞—Ç–Ω–æ–º** –ø–æ—Ä—è–¥–∫—É –≤ —Å–ø–∏—Å–∫–µ uses. –Ø—Å–Ω–æ, —á—Ç–æ –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å **—Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã—Ö —á–∞—Å—Ç–µ–π** –º–æ–¥—É–ª–µ–π. –û–Ω–∞ –∑–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è (–≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤—ã–¥–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤. –æ—à–∏–±–∫–∞). –¶–∏–∫–ª –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –º—ã –≤—Å—Ç—Ä–µ—á–∞–µ–º –º–æ–¥—É–ª—å —Å –Ω–µ –æ—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã —É–∂–µ –±—ã–ª–∏. 

<aside>
üí° –û–¥–Ω–∞–∫–æ –ø–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –µ—â–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ, —á—Ç–æ —Ü–∏–∫–ª –æ–±—Ä–∞–∑–æ–≤–∞–Ω —Ü–µ–ª–∏–∫–æ–º –∏–∑ ‚Äú–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã—Ö —Å–≤—è–∑–µ–π‚Äù, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —Å–ª—É—á–∞–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –≤ –Ω–µ–º —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ implementation —á–∞—Å—Ç—å –º–æ–¥—É–ª—è –æ–Ω –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –º–µ—Ö–∞–Ω–∏–∑–º—É –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏, –ø—Ä–æ –∫–æ—Ç–æ—Ä—É—é —á–∏—Ç–∞–π—Ç–µ –¥–∞–ª–µ–µ.

</aside>

**–ü—Ä–∏–º–µ—Ä –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ —Ü–∏–∫–ª–∞** 
![[–¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.png]]
---

–ï—Å–ª–∏ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã, —Ç–æ –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–∞—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (implementation). **–û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π, –∫–æ–≥–¥–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–µ —á–∞—Å—Ç–∏ –º–æ–¥—É–ª–µ–π —É–∂–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã. –≠—Ç–æ —É—Å–ª–æ–≤–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤—ã—Ö —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –ú–æ–¥—É–ª–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º –º–æ–¥—É–ª–µ –≤ —Å–ø–∏—Å–∫–µ uses —á–∞—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å —Ä–∞–Ω–µ–µ –≤—Å—Ç—Ä–µ—á–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å —Å –µ—â–µ –Ω–µ –æ—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º (–≤ —Å–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –æ–±–∞ —ç—Ç–∏—Ö –º–æ–¥—É–ª—è). 

<aside>
üí° –ú–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤–æ–ø—Ä–æ—Å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–ª—É—á–∞–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–∞—Å—Ç–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –í —ç—Ç–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –º—ã –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –ø–æ–ø–∞–¥–µ–º –≤–æ –≤—Ç–æ—Ä–æ–π —Ä–∞–∑ –≤ –º–æ–¥—É–ª—å —Å –æ—Ç–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–∞—è –¥–∞–ª–µ–µ, –≤ –Ω–∞—á–∞–ª–µ CompileUnit –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –≤—ã—Ö–æ–¥—É –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏. –ê –¥–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –¥–æ–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –ø–æ–∑–∂–µ –≤ –¥—Ä—É–≥–æ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º –≤—ã–∑–æ–≤–µ.

</aside>

```csharp
if (currentUnit.State != UnitState.BeginCompilation || currentUnit.SemanticTree != null) 
{
	AddCurrentUnitAndItsReferencesToUsesLists(unitsFromUsesSection, directUnitsFromUsesSection,
	currentUnitNode, currentUnit, GetReferences(currentUnit));
	return currentUnit;
}
```